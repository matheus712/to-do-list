<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Agenda (cinza metÃ¡lico)</title>

<style>
    :root{
      --bg:#2b2b2b;
      --panel:#3a3a3a;
      --muted:#5a5a5a;
      --metal:#d9d9d9;
      --text:#f2f2f2;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
        margin: 0;
        font-family: "Segoe UI", sans-serif;
        background: var(--bg);
        color: var(--text);
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        overflow: hidden;
        position: relative;
        -webkit-font-smoothing:antialiased;
    }

    /* Estrelas */
    .star {
        position: absolute;
        width: 3px;
        height: 3px;
        background: var(--metal);
        border-radius: 50%;
        animation: blink 2s infinite ease-in-out;
        opacity: 0.7;
        pointer-events:none;
    }

    @keyframes blink {
        0% { opacity: 0.2; transform: scale(1); }
        50% { opacity: 1; transform: scale(1.4); }
        100% { opacity: 0.2; transform: scale(1); }
    }

    /* Center panel */
    .panel{
      width: 92%; max-width:780px; background: rgba(58,58,58,0.95); border-radius:14px; padding:22px;
      box-shadow: 0 8px 40px rgba(0,0,0,0.6); border:1px solid rgba(255,255,255,0.03);
      display:flex;flex-direction:column;gap:16px;align-items:center;
      text-align:center;
    }

    .main-btn{background:var(--panel);border:1px solid var(--muted);padding:12px 20px;border-radius:8px;color:var(--text);cursor:pointer}
    .main-btn:hover{background:#4a4a4a}

    /* Modal common */
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(3px);align-items:center;justify-content:center}
    .modal.show{display:flex}
    .modal-card{background:var(--panel);padding:18px;border-radius:10px;min-width:280px;max-width:480px;box-shadow:0 6px 20px rgba(0,0,0,0.6);}

    .close-btn{position:absolute;right:12px;top:12px;background:var(--panel);padding:6px 10px;border-radius:6px;border:1px solid var(--muted);cursor:pointer}

    input,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid var(--muted);background:transparent;color:var(--text);margin-top:10px}
    .save-btn{width:100%;padding:12px;margin-top:12px;border-radius:8px;border:none;background:var(--muted);color:var(--text);cursor:pointer}

    /* Agenda button */
    .agenda-btn{position:fixed;top:20px;right:20px;background:var(--metal);color:#000;padding:10px 14px;border-radius:8px;border:none;cursor:pointer}

    /* Lista dentro da agenda modal */
    .list{max-height:320px;overflow:auto;margin-top:8px}
    .list-item{background:rgba(0,0,0,0.2);padding:10px;border-radius:8px;margin-bottom:8px;display:flex;justify-content:space-between;align-items:center}
    .muted{color:var(--muted);font-size:0.95rem}

    /* small screens */
    @media (max-width:520px){.modal-card{width:92%;}}
</style>
</head>
<body>

<!-- Stars generated at runtime (no blocking) -->

<div class="panel">
  <h1 style="margin:0;">-Agenda-</h1>
  <p class="muted">Adicione eventos â€” eles sÃ£o salvos automaticamente no seu navegador.</p>
  <button class="main-btn" id="open-add">Adicionar Evento</button>
</div>

<!-- Add Event Modal -->
<div class="modal" id="addModal" aria-hidden="true">
  <div class="modal-card">
    <button class="close-btn" id="closeAdd">âœ•</button>
    <h3 style="margin:0 0 8px 0">Novo Evento</h3>
    <input id="evt-title" placeholder="TÃ­tulo do evento" />
    <textarea id="evt-desc" rows="4" placeholder="DescriÃ§Ã£o (opcional)"></textarea>
    <button class="save-btn" id="saveEvt">Salvar evento</button>
  </div>
</div>

<!-- Agenda Modal (shows saved events) -->
<div class="modal" id="agendaModal" aria-hidden="true">
  <div class="modal-card" style="position:relative;">
    <button class="close-btn" id="closeAgenda">âœ•</button>
    <h3 style="margin:0 0 8px 0">Agenda Salva</h3>
    <div class="list" id="list"></div>
    <div style="display:flex;gap:8px;margin-top:12px;justify-content:center">
      <button id="clearAll" class="save-btn" style="background:#6b6b6b">Limpar tudo</button>
    </div>
  </div>
</div>

<button class="agenda-btn" id="btn-agenda">ðŸ“˜ Agenda</button>

<script>
// -- State and helpers
let events = []; // {id,title,desc,created}
const STORAGE_KEY = 'agenda_events_v1';

function gerarId(){return Date.now().toString(36)+Math.random().toString(36).slice(2,6)}

function salvarStorage(){localStorage.setItem(STORAGE_KEY, JSON.stringify(events));}
function carregarStorage(){try{const raw=localStorage.getItem(STORAGE_KEY);if(raw) events=JSON.parse(raw);}catch(e){events=[]}}

// atualizar: renderiza lista e salva automaticamente
function atualizar(){
  // render list inside agenda modal
  const listEl=document.getElementById('list');
  if(!listEl) return;
  listEl.innerHTML='';
  if(events.length===0){ listEl.innerHTML='<div class="muted">Nenhum evento salvo.</div>'; return; }
  events.slice().reverse().forEach(ev =>{
    const item=document.createElement('div'); item.className='list-item';
    const left=document.createElement('div');
    left.innerHTML='<div style="font-weight:600">'+escapeHtml(ev.title)+'</div><div class="muted">'+(ev.desc?escapeHtml(ev.desc):'')+'</div>';
    const right=document.createElement('div');
    right.innerHTML='<div class="muted">'+new Date(ev.created).toLocaleString()+'</div><button data-id="'+ev.id+'" style="margin-left:10px;background:#bdbdbd;border:none;padding:6px 8px;border-radius:6px;cursor:pointer">Excluir</button>';
    item.appendChild(left); item.appendChild(right);
    listEl.appendChild(item);
  });
  // attach delete handlers
  listEl.querySelectorAll('button[data-id]').forEach(b=>b.addEventListener('click',()=>{ const id=b.getAttribute('data-id'); events=events.filter(x=>x.id!==id); salvarStorage(); atualizar(); }));
  salvarStorage();
}

function escapeHtml(str){ if(!str) return ''; return String(str).replace(/[&<>"']/g, s=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[s])); }

// -- UI wiring (run after DOM ready)
document.addEventListener('DOMContentLoaded',()=>{
  // generate stars safely
  for(let i=0;i<60;i++){const s=document.createElement('div');s.className='star';s.style.left=(Math.random()*100)+'vw';s.style.top=(Math.random()*100)+'vh';s.style.animationDelay=(Math.random()*2)+'s';s.style.transform='scale('+((Math.random()*1.4)+0.6)+')';document.body.appendChild(s);} 

  // elements
  const openAdd=document.getElementById('open-add');
  const addModal=document.getElementById('addModal');
  const closeAdd=document.getElementById('closeAdd');
  const saveBtn=document.getElementById('saveEvt');
  const titleInput=document.getElementById('evt-title');
  const descInput=document.getElementById('evt-desc');
  const agendaBtn=document.getElementById('btn-agenda');
  const agendaModal=document.getElementById('agendaModal');
  const closeAgenda=document.getElementById('closeAgenda');
  const clearAll=document.getElementById('clearAll');

  // load events then render
  carregarStorage(); atualizar();

  // open/close handlers
  openAdd.addEventListener('click',()=>{ addModal.classList.add('show'); titleInput.focus(); });
  closeAdd.addEventListener('click',()=>{ addModal.classList.remove('show'); });
  saveBtn.addEventListener('click',()=>{
    const t=titleInput.value.trim(); const d=descInput.value.trim();
    if(!t){ alert('Digite o tÃ­tulo do evento'); titleInput.focus(); return; }
    events.push({id:gerarId(), title:t, desc:d, created:Date.now()});
    titleInput.value=''; descInput.value=''; addModal.classList.remove('show'); atualizar();
  });

  agendaBtn.addEventListener('click',()=>{ agendaModal.classList.add('show'); });
  closeAgenda.addEventListener('click',()=>{ agendaModal.classList.remove('show'); });
  clearAll.addEventListener('click',()=>{ if(confirm('Deseja limpar todos os eventos?')){ events=[]; atualizar(); agendaModal.classList.remove('show'); } });

  // close modal on backdrop click
  document.querySelectorAll('.modal').forEach(m=>m.addEventListener('click',(e)=>{ if(e.target===m) m.classList.remove('show'); }));

});
</script>
</body>
</html>
